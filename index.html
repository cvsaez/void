<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>VOID</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=BBH+Bartle&family=BBH+Bogle&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="css/styles.css">
</head>
<body>

  <nav>
    <a href="#shop">shop</a>
    <a href="#about">about</a>
    <a href="#contact">contact</a>
    <button id="cart-button" aria-label="Open cart">cart <span id="cart-count">0</span></button>
  </nav>

  <header>
    <div class="header-bg">
      <img src="assets/IMG_0633 (1).png" alt="" aria-hidden="true" class="header-image header-image-1">
      <img src="assets/IMG_0637.PNG" alt="" aria-hidden="true" class="header-image header-image-2">
    </div>
    <h1>VOID</h1>
  </header>

  <section id="shop">
    <h2>DROP001</h2>
    <div class="products">
      <article class="product-card">
        <div class="card-carousel">
          <button class="card-carousel-btn card-carousel-prev" aria-label="Previous">‹</button>
          <div class="card-carousel-container">
            <div class="card-carousel-item active">
              <img src="assets/sweater/IMG_9457.JPEG" alt="VOID Sweater">
            </div>
            <div class="card-carousel-item">
              <img src="assets/sweater/IMG_9460.JPEG" alt="VOID Sweater">
            </div>
            <div class="card-carousel-item">
              <img src="assets/sweater/IMG_9463.JPEG" alt="VOID Sweater">
            </div>
            <div class="card-carousel-item">
              <img src="assets/sweater/IMG_9464.JPEG" alt="VOID Sweater">
            </div>
            <div class="card-carousel-item">
              <video src="assets/sweater/IMG_9449.MP4" preload="metadata" loop muted playsinline></video>
            </div>
            <div class="card-carousel-item">
              <video src="assets/sweater/IMG_9456.MOV" preload="metadata" loop muted playsinline></video>
            </div>
            <div class="card-carousel-item">
              <video src="assets/sweater/IMG_9478.MP4" preload="metadata" loop muted playsinline></video>
            </div>
            <div class="card-carousel-item">
              <video src="assets/sweater/IMG_9480.MP4" preload="metadata" loop muted playsinline></video>
            </div>
          </div>
          <button class="card-carousel-btn card-carousel-next" aria-label="Next">›</button>
          <div class="carousel-indicators"></div>
        </div>
        <div class="product-details">
          <h3>SWEATER</h3>
          <div class="price">65€</div>
          <p class="size-info">SIZE: XL BAGGY</p>
          <div class="product-actions">
            <button class="btn primary" data-product="sweater" data-name="SWEATER" data-price="65">buy now</button>
            <button class="btn ghost" data-product="sweater" data-name="SWEATER" data-price="65">add to cart</button>
          </div>
        </div>
      </article>

      <article class="product-card">
        <div class="card-carousel">
          <button class="card-carousel-btn card-carousel-prev" aria-label="Previous">‹</button>
          <div class="card-carousel-container">
            <div class="card-carousel-item active">
              <img src="assets/triptych/IMG_9509.JPEG" alt="Triptych">
            </div>
            <div class="card-carousel-item">
              <img src="assets/triptych/IMG_9515.png" alt="Triptych">
            </div>
            <div class="card-carousel-item">
              <img src="assets/triptych/IMG_9516.png" alt="Triptych">
            </div>
            <div class="card-carousel-item">
              <img src="assets/triptych/IMG_9517.png" alt="Triptych">
            </div>
          </div>
          <button class="card-carousel-btn card-carousel-next" aria-label="Next">›</button>
          <div class="carousel-indicators"></div>
        </div>
        <div class="product-details">
          <h3>TRIPTYCH</h3>
          <div class="price">50€</div>
          <p class="size-info">SIZE: A2 (50 cm x 65 cm)</p>
          <div class="product-actions">
            <button class="btn primary" data-product="triptych" data-name="TRIPTYCH" data-price="50">buy now</button>
            <button class="btn ghost" data-product="triptych" data-name="TRIPTYCH" data-price="50">add to cart</button>
          </div>
        </div>
      </article>
    </div>
  </section>

  <section id="about">
    <h2>about void</h2>
  </section>

  <footer id="contact">
    <div class="contact-icons">
      <a href="https://instagram.com/void.vacio.nobody.nadie" target="_blank" rel="noopener noreferrer" aria-label="Instagram">
        <svg class="contact-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect>
          <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path>
          <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line>
        </svg>
      </a>
      <a href="mailto:void.vacio.nobody.nadie@gmail.com" aria-label="Email">
        <svg class="contact-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
          <polyline points="22,6 12,13 2,6"></polyline>
        </svg>
      </a>
    </div>
  </footer>

  <!-- Cart overlay -->
  <div id="cart-overlay" class="cart-overlay" hidden>
    <div class="cart-panel" role="dialog" aria-modal="true" aria-labelledby="cart-title">
      <div class="cart-header">
        <h2 id="cart-title">cart</h2>
        <button class="close-cart" aria-label="Close cart">×</button>
      </div>
      <div class="cart-items" id="cart-items"></div>
      <div class="cart-footer">
        <div class="cart-total">total: <span id="cart-total">0€</span></div>
        <div class="cart-actions">
          <a class="btn primary" href="checkout.html">buy</a>
          <button class="btn ghost" id="cart-clear">clear</button>
        </div>
      </div>
    </div>
  </div>

  <script src="js/cart.js"></script>
  <script>
    // Page transition handler
    document.addEventListener('DOMContentLoaded', () => {
      const links = document.querySelectorAll('a[href]:not([target="_blank"])');
      links.forEach(link => {
        link.addEventListener('click', (e) => {
          const href = link.getAttribute('href');
          if (href && !href.startsWith('#') && !href.startsWith('javascript:')) {
            e.preventDefault();
            document.body.classList.add('page-transitioning');
            setTimeout(() => {
              window.location.href = href;
            }, 300);
          }
        });
      });
    });

    (function() {
      const root = document.documentElement;
      let ticking = false;

      function updateBackground() {
        ticking = false;
        const scrollable = document.documentElement.scrollHeight - window.innerHeight;
        const y = window.scrollY || window.pageYOffset || 0;
        let p = scrollable > 0 ? Math.min(Math.max(y / scrollable, 0), 1) : 0;
        
        // Acelerar la transición a negro
        p = Math.min(p * 5, 1);
        
        // Interpolar de blanco (255,255,255) a negro (0,0,0)
        const r = Math.round(255 * (1 - p));
        const g = Math.round(255 * (1 - p));
        const b = Math.round(255 * (1 - p));
        const bgColor = `rgb(${r}, ${g}, ${b})`;
        root.style.setProperty('--scroll-bg', bgColor);
        
        // Controlar opacidad de las imágenes
        // Imagen 1 desaparece (1 -> 0)
        // Imagen 2 aparece (0 -> 1)
        const img1Opacity = 1 - p;
        const img2Opacity = p;
        root.style.setProperty('--img1-opacity', img1Opacity);
        root.style.setProperty('--img2-opacity', img2Opacity);
      }

      function onScroll() {
        if (!ticking) {
          ticking = true;
          requestAnimationFrame(updateBackground);
        }
      }

      window.addEventListener('scroll', onScroll, { passive: true });
      window.addEventListener('resize', () => updateBackground(), { passive: true });
      window.addEventListener('load', () => updateBackground());

      updateBackground();

      // Carrusel de tarjeta de producto
      document.querySelectorAll('.card-carousel').forEach(carousel => {
        const container = carousel.querySelector('.card-carousel-container');
        const items = carousel.querySelectorAll('.card-carousel-item');
        const indicatorsContainer = carousel.querySelector('.carousel-indicators');
        const prevBtn = carousel.querySelector('.card-carousel-prev');
        const nextBtn = carousel.querySelector('.card-carousel-next');
        let currentIndex = 0;
        let isDragging = false;
        let startX = 0;
        let currentTranslate = 0;
        let prevTranslate = 0;

        // Crear indicadores
        items.forEach((_, index) => {
          const dot = document.createElement('span');
          dot.classList.add('carousel-dot');
          if (index === 0) dot.classList.add('active');
          dot.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            currentIndex = index;
            updateCarousel();
          });
          indicatorsContainer.appendChild(dot);
        });

        const dots = carousel.querySelectorAll('.carousel-dot');

        function setTransform(translate) {
          container.style.transition = 'none';
          container.style.transform = `translateX(${translate}px)`;
        }

        function updateCarousel(animated = true) {
          container.style.transition = animated ? 'transform 0.3s ease' : 'none';
          currentTranslate = -currentIndex * container.offsetWidth;
          prevTranslate = currentTranslate;
          container.style.transform = `translateX(${currentTranslate}px)`;
          
          // Actualizar indicadores
          dots.forEach((dot, index) => {
            dot.classList.toggle('active', index === currentIndex);
          });
          
          // Pausar todos los videos
          items.forEach((item, idx) => {
            const video = item.querySelector('video');
            if (video && idx !== currentIndex) {
              video.pause();
              video.currentTime = 0;
            }
          });

          // Reproducir video activo si existe
          const activeVideo = items[currentIndex].querySelector('video');
          if (activeVideo) {
            activeVideo.play().catch(e => console.log('Autoplay prevented:', e));
          }
        }

        // Flechas
        prevBtn.addEventListener('click', (e) => {
          e.preventDefault();
          e.stopPropagation();
          currentIndex = (currentIndex - 1 + items.length) % items.length;
          updateCarousel();
        });

        nextBtn.addEventListener('click', (e) => {
          e.preventDefault();
          e.stopPropagation();
          currentIndex = (currentIndex + 1) % items.length;
          updateCarousel();
        });

        // Drag interactivo
        container.addEventListener('touchstart', (e) => {
          isDragging = true;
          startX = e.touches[0].clientX;
        });

        container.addEventListener('touchmove', (e) => {
          if (!isDragging) return;
          const currentX = e.touches[0].clientX;
          const diff = currentX - startX;
          currentTranslate = prevTranslate + diff;
          setTransform(currentTranslate);
        });

        container.addEventListener('touchend', () => {
          isDragging = false;
          const movedBy = currentTranslate - prevTranslate;
          const threshold = container.offsetWidth / 4;

          if (movedBy < -threshold && currentIndex < items.length - 1) {
            currentIndex++;
          } else if (movedBy > threshold && currentIndex > 0) {
            currentIndex--;
          }

          updateCarousel();
        });

        updateCarousel(false);
      });

      // Botones de compra
      document.querySelectorAll('.product-actions .btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          e.preventDefault();
          const productName = btn.dataset.name;
          const productPrice = parseInt(btn.dataset.price);
          
          if (window.VoidCart) {
            window.VoidCart.add({
              id: btn.dataset.product,
              name: productName,
              price: productPrice,
              quantity: 1
            });
            
            // Si es "buy now", abrir el carrito
            if (btn.classList.contains('primary')) {
              window.VoidCart.open();
            }
          }
        });
      });

      // init carrito
      if (window.VoidCart) {
        window.VoidCart.init({
          countEl: document.getElementById('cart-count'),
          buttonEl: document.getElementById('cart-button'),
          overlayEl: document.getElementById('cart-overlay'),
          itemsEl: document.getElementById('cart-items'),
          totalEl: document.getElementById('cart-total'),
          clearEl: document.getElementById('cart-clear'),
          closeEl: document.querySelector('.close-cart')
        });
      }
    })();
  </script>

</body>
</html>
